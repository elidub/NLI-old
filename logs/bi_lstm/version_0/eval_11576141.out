Namespace(model_type='bi_lstm', ckpt_path=None, version='version_0', path_to_vocab='store/vocab.pkl', path_to_data='./SentEval/data')
2023-04-16 11:08:23,612 : ***** Transfer task : MR *****


2023-04-16 11:08:23,762 : Loading model from logs/bi_lstm/version_0/checkpoints/epoch=6-step=60088.ckpt
2023-04-16 11:08:26,691 : open file: /home/lcur1112/NLI/logs/bi_lstm/version_0/checkpoints/epoch=6-step=60088.ckpt
2023-04-16 11:08:26,932 : Evaluating!
2023-04-16 11:08:26,948 : Generating sentence embeddings
2023-04-16 11:11:34,418 : Generated sentence embeddings
2023-04-16 11:11:34,419 : Training pytorch-MLP-nhid0-adam-bs64 with (inner) 2-fold cross-validation
2023-04-16 11:11:47,443 : Best param found at split 1: l2reg = 0.001                 with score 72.09
2023-04-16 11:12:01,002 : Best param found at split 2: l2reg = 0.001                 with score 70.38
2023-04-16 11:12:03,267 : Dev acc : 71.24 Test acc : 71.4

2023-04-16 11:12:03,274 : ***** Transfer task : CR *****


2023-04-16 11:12:03,291 : Loading model from logs/bi_lstm/version_0/checkpoints/epoch=6-step=60088.ckpt
2023-04-16 11:12:06,095 : open file: /home/lcur1112/NLI/logs/bi_lstm/version_0/checkpoints/epoch=6-step=60088.ckpt
2023-04-16 11:12:06,262 : Evaluating!
2023-04-16 11:12:06,271 : Generating sentence embeddings
Sentence length exceeding 106
2023-04-16 11:13:09,435 : Generated sentence embeddings
2023-04-16 11:13:09,436 : Training pytorch-MLP-nhid0-adam-bs64 with (inner) 2-fold cross-validation
2023-04-16 11:13:14,328 : Best param found at split 1: l2reg = 0.001                 with score 76.68
2023-04-16 11:13:19,660 : Best param found at split 2: l2reg = 0.001                 with score 76.43
2023-04-16 11:13:20,310 : Dev acc : 76.56 Test acc : 76.03

2023-04-16 11:13:20,314 : ***** Transfer task : MPQA *****


2023-04-16 11:13:20,325 : Loading model from logs/bi_lstm/version_0/checkpoints/epoch=6-step=60088.ckpt
2023-04-16 11:13:23,190 : open file: /home/lcur1112/NLI/logs/bi_lstm/version_0/checkpoints/epoch=6-step=60088.ckpt
2023-04-16 11:13:23,328 : Evaluating!
2023-04-16 11:13:23,339 : Generating sentence embeddings
2023-04-16 11:13:57,531 : Generated sentence embeddings
2023-04-16 11:13:57,532 : Training pytorch-MLP-nhid0-adam-bs64 with (inner) 2-fold cross-validation
2023-04-16 11:14:07,829 : Best param found at split 1: l2reg = 0.001                 with score 84.52
2023-04-16 11:14:21,077 : Best param found at split 2: l2reg = 0.001                 with score 83.97
2023-04-16 11:14:23,558 : Dev acc : 84.24 Test acc : 84.54

2023-04-16 11:14:23,563 : ***** Transfer task : SUBJ *****


2023-04-16 11:14:23,798 : Loading model from logs/bi_lstm/version_0/checkpoints/epoch=6-step=60088.ckpt
2023-04-16 11:14:26,659 : open file: /home/lcur1112/NLI/logs/bi_lstm/version_0/checkpoints/epoch=6-step=60088.ckpt
2023-04-16 11:14:26,820 : Evaluating!
2023-04-16 11:14:26,839 : Generating sentence embeddings
Sentence length exceeding 107
Sentence length exceeding 122
2023-04-16 11:17:48,357 : Generated sentence embeddings
2023-04-16 11:17:48,359 : Training pytorch-MLP-nhid0-adam-bs64 with (inner) 2-fold cross-validation
2023-04-16 11:18:01,848 : Best param found at split 1: l2reg = 1e-05                 with score 87.34
2023-04-16 11:18:20,516 : Best param found at split 2: l2reg = 1e-05                 with score 87.28
2023-04-16 11:18:22,867 : Dev acc : 87.31 Test acc : 87.51

2023-04-16 11:18:22,875 : ***** Transfer task : SST Binary classification *****


2023-04-16 11:18:23,008 : Loading model from logs/bi_lstm/version_0/checkpoints/epoch=6-step=60088.ckpt
2023-04-16 11:18:26,052 : open file: /home/lcur1112/NLI/logs/bi_lstm/version_0/checkpoints/epoch=6-step=60088.ckpt
2023-04-16 11:18:26,194 : Evaluating!
2023-04-16 11:18:26,195 : Computing embedding for train
2023-04-16 11:27:33,792 : Computed train embeddings
2023-04-16 11:27:33,792 : Computing embedding for dev
2023-04-16 11:27:48,573 : Computed dev embeddings
2023-04-16 11:27:48,573 : Computing embedding for test
2023-04-16 11:28:18,909 : Computed test embeddings
2023-04-16 11:28:18,909 : Training pytorch-MLP-nhid0-adam-bs64 with standard validation..
2023-04-16 11:30:10,121 : [('reg:1e-05', 78.67), ('reg:0.0001', 78.67), ('reg:0.001', 77.41), ('reg:0.01', 74.89)]
2023-04-16 11:30:10,121 : Validation : best param found is reg = 1e-05 with score             78.67
2023-04-16 11:30:10,121 : Evaluating...
2023-04-16 11:30:41,870 : 
Dev acc : 78.67 Test acc : 77.59 for             SST Binary classification

2023-04-16 11:30:41,883 : ***** Transfer task : TREC *****


2023-04-16 11:30:41,968 : Loading model from logs/bi_lstm/version_0/checkpoints/epoch=6-step=60088.ckpt
2023-04-16 11:30:44,981 : open file: /home/lcur1112/NLI/logs/bi_lstm/version_0/checkpoints/epoch=6-step=60088.ckpt
2023-04-16 11:30:45,146 : Evaluating!
2023-04-16 11:31:33,266 : Computed train embeddings
2023-04-16 11:31:36,843 : Computed test embeddings
2023-04-16 11:31:36,844 : Training pytorch-MLP-nhid0-adam-bs64 with 2-fold cross-validation
2023-04-16 11:31:56,370 : [('reg:1e-05', 68.78), ('reg:0.0001', 67.9), ('reg:0.001', 67.41), ('reg:0.01', 60.44)]
2023-04-16 11:31:56,371 : Cross-validation : best param found is reg = 1e-05             with score 68.78
2023-04-16 11:31:56,371 : Evaluating...
2023-04-16 11:32:00,968 : 
Dev acc : 68.78 Test acc : 73.2             for TREC

2023-04-16 11:32:00,973 : ***** Transfer task : MRPC *****


2023-04-16 11:32:01,015 : Loading model from logs/bi_lstm/version_0/checkpoints/epoch=6-step=60088.ckpt
2023-04-16 11:32:04,097 : open file: /home/lcur1112/NLI/logs/bi_lstm/version_0/checkpoints/epoch=6-step=60088.ckpt
2023-04-16 11:32:04,247 : Evaluating!
2023-04-16 11:32:04,249 : Computing embedding for train
2023-04-16 11:34:36,475 : Computed train embeddings
2023-04-16 11:34:36,475 : Computing embedding for test
2023-04-16 11:35:42,726 : Computed test embeddings
2023-04-16 11:35:42,859 : Training pytorch-MLP-nhid0-adam-bs64 with 2-fold cross-validation
2023-04-16 11:35:52,766 : [('reg:1e-05', 70.78), ('reg:0.0001', 70.71), ('reg:0.001', 70.58), ('reg:0.01', 69.41)]
2023-04-16 11:35:52,766 : Cross-validation : best param found is reg = 1e-05             with score 70.78
2023-04-16 11:35:52,766 : Evaluating...
2023-04-16 11:35:54,717 : Dev acc : 70.78 Test acc 71.59; Test F1 81.17 for MRPC.

2023-04-16 11:35:54,720 : ***** Transfer task : SICK-Entailment*****


2023-04-16 11:35:54,768 : Loading model from logs/bi_lstm/version_0/checkpoints/epoch=6-step=60088.ckpt
2023-04-16 11:35:57,795 : open file: /home/lcur1112/NLI/logs/bi_lstm/version_0/checkpoints/epoch=6-step=60088.ckpt
2023-04-16 11:35:57,954 : Evaluating!
2023-04-16 11:35:57,956 : Computing embedding for train
2023-04-16 11:37:18,146 : Computed train embeddings
2023-04-16 11:37:18,147 : Computing embedding for dev
2023-04-16 11:37:27,772 : Computed dev embeddings
2023-04-16 11:37:27,772 : Computing embedding for test
2023-04-16 11:38:54,784 : Computed test embeddings
2023-04-16 11:38:55,082 : Training pytorch-MLP-nhid0-adam-bs64 with standard validation..
2023-04-16 11:39:04,995 : [('reg:1e-05', 83.4), ('reg:0.0001', 83.2), ('reg:0.001', 82.0), ('reg:0.01', 80.4)]
2023-04-16 11:39:04,996 : Validation : best param found is reg = 1e-05 with score             83.4
2023-04-16 11:39:04,996 : Evaluating...
2023-04-16 11:39:07,917 : 
Dev acc : 83.4 Test acc : 84.13 for                        SICK entailment

2023-04-16 11:39:07,920 : ***** Transfer task : STS14 *****


/home/lcur1112/.conda/envs/nli/lib/python3.10/site-packages/SentEval-0.1.0-py3.10.egg/senteval/sts.py:42: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray.
/home/lcur1112/.conda/envs/nli/lib/python3.10/site-packages/SentEval-0.1.0-py3.10.egg/senteval/sts.py:43: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray.
2023-04-16 11:39:07,958 : Loading model from logs/bi_lstm/version_0/checkpoints/epoch=6-step=60088.ckpt
2023-04-16 11:39:10,949 : open file: /home/lcur1112/NLI/logs/bi_lstm/version_0/checkpoints/epoch=6-step=60088.ckpt
2023-04-16 11:39:11,105 : Evaluating!
2023-04-16 11:39:20,389 : deft-forum : pearson = 0.1793, spearman = 0.1563
2023-04-16 11:39:31,798 : deft-news : pearson = 0.4244, spearman = 0.4341
2023-04-16 11:39:43,299 : headlines : pearson = 0.4602, spearman = 0.4199
2023-04-16 11:39:57,560 : images : pearson = 0.7792, spearman = 0.7421
2023-04-16 11:40:10,721 : OnWN : pearson = 0.5179, spearman = 0.5577
2023-04-16 11:40:27,641 : tweet-news : pearson = 0.4575, spearman = 0.4191
2023-04-16 11:40:27,641 : ALL (weighted average) : Pearson = 0.4984,             Spearman = 0.4812
2023-04-16 11:40:27,642 : ALL (average) : Pearson = 0.4697,             Spearman = 0.4549

{'MR': {'devacc': 71.24, 'acc': 71.4, 'ndev': 10662, 'ntest': 10662}, 'CR': {'devacc': 76.56, 'acc': 76.03, 'ndev': 3775, 'ntest': 3775}, 'MPQA': {'devacc': 84.24, 'acc': 84.54, 'ndev': 10606, 'ntest': 10606}, 'SUBJ': {'devacc': 87.31, 'acc': 87.51, 'ndev': 10000, 'ntest': 10000}, 'SST2': {'devacc': 78.67, 'acc': 77.59, 'ndev': 872, 'ntest': 1821}, 'TREC': {'devacc': 68.78, 'acc': 73.2, 'ndev': 5452, 'ntest': 500}, 'MRPC': {'devacc': 70.78, 'acc': 71.59, 'f1': 81.17, 'ndev': 4076, 'ntest': 1725}, 'SICKEntailment': {'devacc': 83.4, 'acc': 84.13, 'ndev': 500, 'ntest': 4927}, 'STS14': {'deft-forum': {'pearson': PearsonRResult(statistic=0.17931231731440145, pvalue=0.00013117164351223414), 'spearman': SignificanceResult(statistic=0.15628558649309515, pvalue=0.0008792498363755978), 'nsamples': 450}, 'deft-news': {'pearson': PearsonRResult(statistic=0.4244273748938109, pvalue=1.5053333622563e-14), 'spearman': SignificanceResult(statistic=0.4341472020240693, pvalue=3.2069186429896494e-15), 'nsamples': 300}, 'headlines': {'pearson': PearsonRResult(statistic=0.4601673776332297, pvalue=1.4167710528899002e-40), 'spearman': SignificanceResult(statistic=0.4198730614457582, pvalue=2.1776889649473512e-33), 'nsamples': 750}, 'images': {'pearson': PearsonRResult(statistic=0.7791890884965597, pvalue=6.600450453726875e-154), 'spearman': SignificanceResult(statistic=0.7421107473093383, pvalue=4.288166561603098e-132), 'nsamples': 750}, 'OnWN': {'pearson': PearsonRResult(statistic=0.5178597098452022, pvalue=1.0878214589456291e-52), 'spearman': SignificanceResult(statistic=0.5577243090719185, pvalue=1.5770401766839907e-62), 'nsamples': 750}, 'tweet-news': {'pearson': PearsonRResult(statistic=0.4575007557121319, pvalue=4.5420925794452036e-40), 'spearman': SignificanceResult(statistic=0.4190743819958505, pvalue=2.9572197039054325e-33), 'nsamples': 750}, 'all': {'pearson': {'mean': 0.4697427706492226, 'wmean': 0.49841505440665773}, 'spearman': {'mean': 0.4548692147233384, 'wmean': 0.48124254650567005}}}}
