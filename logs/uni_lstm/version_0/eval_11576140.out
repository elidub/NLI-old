Namespace(model_type='uni_lstm', ckpt_path=None, version='version_2', path_to_vocab='store/vocab.pkl', path_to_data='./SentEval/data')
2023-04-16 10:59:40,221 : ***** Transfer task : MR *****


2023-04-16 10:59:40,360 : Loading model from logs/uni_lstm/version_2/checkpoints/epoch=6-step=60088.ckpt
2023-04-16 10:59:43,164 : open file: /home/lcur1112/NLI/logs/uni_lstm/version_2/checkpoints/epoch=6-step=60088.ckpt
2023-04-16 10:59:43,268 : Evaluating!
2023-04-16 10:59:43,283 : Generating sentence embeddings
2023-04-16 11:01:19,435 : Generated sentence embeddings
2023-04-16 11:01:19,436 : Training pytorch-MLP-nhid0-adam-bs64 with (inner) 2-fold cross-validation
2023-04-16 11:01:30,987 : Best param found at split 1: l2reg = 1e-05                 with score 70.74
2023-04-16 11:01:43,614 : Best param found at split 2: l2reg = 1e-05                 with score 69.91
2023-04-16 11:01:45,722 : Dev acc : 70.32 Test acc : 69.6

2023-04-16 11:01:45,729 : ***** Transfer task : CR *****


2023-04-16 11:01:45,746 : Loading model from logs/uni_lstm/version_2/checkpoints/epoch=6-step=60088.ckpt
2023-04-16 11:01:48,380 : open file: /home/lcur1112/NLI/logs/uni_lstm/version_2/checkpoints/epoch=6-step=60088.ckpt
2023-04-16 11:01:48,502 : Evaluating!
2023-04-16 11:01:48,510 : Generating sentence embeddings
Sentence length exceeding 106
2023-04-16 11:02:21,483 : Generated sentence embeddings
2023-04-16 11:02:21,483 : Training pytorch-MLP-nhid0-adam-bs64 with (inner) 2-fold cross-validation
2023-04-16 11:02:26,308 : Best param found at split 1: l2reg = 0.001                 with score 75.36
2023-04-16 11:02:31,669 : Best param found at split 2: l2reg = 0.01                 with score 74.63
2023-04-16 11:02:32,547 : Dev acc : 75.0 Test acc : 75.34

2023-04-16 11:02:32,549 : ***** Transfer task : MPQA *****


2023-04-16 11:02:32,561 : Loading model from logs/uni_lstm/version_2/checkpoints/epoch=6-step=60088.ckpt
2023-04-16 11:02:35,277 : open file: /home/lcur1112/NLI/logs/uni_lstm/version_2/checkpoints/epoch=6-step=60088.ckpt
2023-04-16 11:02:35,381 : Evaluating!
2023-04-16 11:02:35,393 : Generating sentence embeddings
2023-04-16 11:02:57,512 : Generated sentence embeddings
2023-04-16 11:02:57,513 : Training pytorch-MLP-nhid0-adam-bs64 with (inner) 2-fold cross-validation
2023-04-16 11:03:09,220 : Best param found at split 1: l2reg = 0.001                 with score 84.01
2023-04-16 11:03:22,858 : Best param found at split 2: l2reg = 1e-05                 with score 83.97
2023-04-16 11:03:25,207 : Dev acc : 83.99 Test acc : 83.85

2023-04-16 11:03:25,210 : ***** Transfer task : SUBJ *****


2023-04-16 11:03:25,459 : Loading model from logs/uni_lstm/version_2/checkpoints/epoch=6-step=60088.ckpt
2023-04-16 11:03:28,173 : open file: /home/lcur1112/NLI/logs/uni_lstm/version_2/checkpoints/epoch=6-step=60088.ckpt
2023-04-16 11:03:28,291 : Evaluating!
2023-04-16 11:03:28,308 : Generating sentence embeddings
Sentence length exceeding 107
Sentence length exceeding 122
2023-04-16 11:05:11,792 : Generated sentence embeddings
2023-04-16 11:05:11,793 : Training pytorch-MLP-nhid0-adam-bs64 with (inner) 2-fold cross-validation
2023-04-16 11:05:26,336 : Best param found at split 1: l2reg = 1e-05                 with score 84.16
2023-04-16 11:05:42,945 : Best param found at split 2: l2reg = 0.0001                 with score 84.02
2023-04-16 11:05:45,708 : Dev acc : 84.09 Test acc : 84.17

2023-04-16 11:05:45,711 : ***** Transfer task : SST Binary classification *****


2023-04-16 11:05:45,849 : Loading model from logs/uni_lstm/version_2/checkpoints/epoch=6-step=60088.ckpt
2023-04-16 11:05:48,634 : open file: /home/lcur1112/NLI/logs/uni_lstm/version_2/checkpoints/epoch=6-step=60088.ckpt
2023-04-16 11:05:48,739 : Evaluating!
2023-04-16 11:05:48,741 : Computing embedding for train
2023-04-16 11:10:44,432 : Computed train embeddings
2023-04-16 11:10:44,433 : Computing embedding for dev
2023-04-16 11:10:52,134 : Computed dev embeddings
2023-04-16 11:10:52,134 : Computing embedding for test
2023-04-16 11:11:07,986 : Computed test embeddings
2023-04-16 11:11:07,986 : Training pytorch-MLP-nhid0-adam-bs64 with standard validation..
2023-04-16 11:13:01,485 : [('reg:1e-05', 77.41), ('reg:0.0001', 77.75), ('reg:0.001', 76.72), ('reg:0.01', 75.69)]
2023-04-16 11:13:01,486 : Validation : best param found is reg = 0.0001 with score             77.75
2023-04-16 11:13:01,486 : Evaluating...
2023-04-16 11:13:31,182 : 
Dev acc : 77.75 Test acc : 75.07 for             SST Binary classification

2023-04-16 11:13:31,186 : ***** Transfer task : TREC *****


2023-04-16 11:13:31,269 : Loading model from logs/uni_lstm/version_2/checkpoints/epoch=6-step=60088.ckpt
2023-04-16 11:13:34,117 : open file: /home/lcur1112/NLI/logs/uni_lstm/version_2/checkpoints/epoch=6-step=60088.ckpt
2023-04-16 11:13:34,234 : Evaluating!
2023-04-16 11:14:00,299 : Computed train embeddings
2023-04-16 11:14:02,236 : Computed test embeddings
2023-04-16 11:14:02,236 : Training pytorch-MLP-nhid0-adam-bs64 with 2-fold cross-validation
2023-04-16 11:14:18,709 : [('reg:1e-05', 57.67), ('reg:0.0001', 57.61), ('reg:0.001', 56.9), ('reg:0.01', 52.88)]
2023-04-16 11:14:18,710 : Cross-validation : best param found is reg = 1e-05             with score 57.67
2023-04-16 11:14:18,710 : Evaluating...
2023-04-16 11:14:21,751 : 
Dev acc : 57.67 Test acc : 68.0             for TREC

2023-04-16 11:14:21,756 : ***** Transfer task : MRPC *****


2023-04-16 11:14:21,795 : Loading model from logs/uni_lstm/version_2/checkpoints/epoch=6-step=60088.ckpt
2023-04-16 11:14:24,535 : open file: /home/lcur1112/NLI/logs/uni_lstm/version_2/checkpoints/epoch=6-step=60088.ckpt
2023-04-16 11:14:24,637 : Evaluating!
2023-04-16 11:14:24,639 : Computing embedding for train
2023-04-16 11:15:42,604 : Computed train embeddings
2023-04-16 11:15:42,605 : Computing embedding for test
2023-04-16 11:16:16,358 : Computed test embeddings
2023-04-16 11:16:16,417 : Training pytorch-MLP-nhid0-adam-bs64 with 2-fold cross-validation
2023-04-16 11:16:27,350 : [('reg:1e-05', 71.27), ('reg:0.0001', 71.2), ('reg:0.001', 70.76), ('reg:0.01', 69.41)]
2023-04-16 11:16:27,350 : Cross-validation : best param found is reg = 1e-05             with score 71.27
2023-04-16 11:16:27,350 : Evaluating...
2023-04-16 11:16:29,014 : Dev acc : 71.27 Test acc 71.77; Test F1 80.4 for MRPC.

2023-04-16 11:16:29,015 : ***** Transfer task : SICK-Entailment*****


2023-04-16 11:16:29,061 : Loading model from logs/uni_lstm/version_2/checkpoints/epoch=6-step=60088.ckpt
2023-04-16 11:16:31,929 : open file: /home/lcur1112/NLI/logs/uni_lstm/version_2/checkpoints/epoch=6-step=60088.ckpt
2023-04-16 11:16:32,042 : Evaluating!
2023-04-16 11:16:32,044 : Computing embedding for train
2023-04-16 11:17:16,062 : Computed train embeddings
2023-04-16 11:17:16,062 : Computing embedding for dev
2023-04-16 11:17:21,258 : Computed dev embeddings
2023-04-16 11:17:21,259 : Computing embedding for test
2023-04-16 11:18:08,661 : Computed test embeddings
2023-04-16 11:18:08,789 : Training pytorch-MLP-nhid0-adam-bs64 with standard validation..
2023-04-16 11:18:18,045 : [('reg:1e-05', 82.8), ('reg:0.0001', 82.6), ('reg:0.001', 82.4), ('reg:0.01', 81.2)]
2023-04-16 11:18:18,046 : Validation : best param found is reg = 1e-05 with score             82.8
2023-04-16 11:18:18,046 : Evaluating...
2023-04-16 11:18:20,483 : 
Dev acc : 82.8 Test acc : 82.99 for                        SICK entailment

2023-04-16 11:18:20,485 : ***** Transfer task : STS14 *****


/home/lcur1112/.conda/envs/nli/lib/python3.10/site-packages/SentEval-0.1.0-py3.10.egg/senteval/sts.py:42: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray.
/home/lcur1112/.conda/envs/nli/lib/python3.10/site-packages/SentEval-0.1.0-py3.10.egg/senteval/sts.py:43: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray.
2023-04-16 11:18:20,522 : Loading model from logs/uni_lstm/version_2/checkpoints/epoch=6-step=60088.ckpt
2023-04-16 11:18:23,219 : open file: /home/lcur1112/NLI/logs/uni_lstm/version_2/checkpoints/epoch=6-step=60088.ckpt
2023-04-16 11:18:23,323 : Evaluating!
2023-04-16 11:18:27,937 : deft-forum : pearson = 0.3506, spearman = 0.3660
2023-04-16 11:18:33,892 : deft-news : pearson = 0.5148, spearman = 0.4947
2023-04-16 11:18:40,294 : headlines : pearson = 0.4113, spearman = 0.3926
2023-04-16 11:18:48,049 : images : pearson = 0.7785, spearman = 0.7399
2023-04-16 11:18:55,277 : OnWN : pearson = 0.5853, spearman = 0.6224
2023-04-16 11:19:04,571 : tweet-news : pearson = 0.4320, spearman = 0.3973
2023-04-16 11:19:04,571 : ALL (weighted average) : Pearson = 0.5247,             Spearman = 0.5139
2023-04-16 11:19:04,571 : ALL (average) : Pearson = 0.5121,             Spearman = 0.5021

{'MR': {'devacc': 70.32, 'acc': 69.6, 'ndev': 10662, 'ntest': 10662}, 'CR': {'devacc': 75.0, 'acc': 75.34, 'ndev': 3775, 'ntest': 3775}, 'MPQA': {'devacc': 83.99, 'acc': 83.85, 'ndev': 10606, 'ntest': 10606}, 'SUBJ': {'devacc': 84.09, 'acc': 84.17, 'ndev': 10000, 'ntest': 10000}, 'SST2': {'devacc': 77.75, 'acc': 75.07, 'ndev': 872, 'ntest': 1821}, 'TREC': {'devacc': 57.67, 'acc': 68.0, 'ndev': 5452, 'ntest': 500}, 'MRPC': {'devacc': 71.27, 'acc': 71.77, 'f1': 80.4, 'ndev': 4076, 'ntest': 1725}, 'SICKEntailment': {'devacc': 82.8, 'acc': 82.99, 'ndev': 500, 'ntest': 4927}, 'STS14': {'deft-forum': {'pearson': PearsonRResult(statistic=0.35061202124028845, pvalue=1.8382574233107173e-14), 'spearman': SignificanceResult(statistic=0.36604718477970816, pvalue=1.0269821044137225e-15), 'nsamples': 450}, 'deft-news': {'pearson': PearsonRResult(statistic=0.5148487568062337, pvalue=1.0461148772838286e-21), 'spearman': SignificanceResult(statistic=0.4946554654754885, pvalue=6.411744479919107e-20), 'nsamples': 300}, 'headlines': {'pearson': PearsonRResult(statistic=0.4113157144856979, pvalue=5.537911643287134e-32), 'spearman': SignificanceResult(statistic=0.3926216290465146, pvalue=4.732906475004085e-29), 'nsamples': 750}, 'images': {'pearson': PearsonRResult(statistic=0.778472762009793, pvalue=1.9082369018174298e-153), 'spearman': SignificanceResult(statistic=0.7398596327973332, pvalue=6.842750110421135e-131), 'nsamples': 750}, 'OnWN': {'pearson': PearsonRResult(statistic=0.5852576326326184, pvalue=3.827013348655668e-70), 'spearman': SignificanceResult(statistic=0.6224081960775484, pvalue=1.1917471036120011e-81), 'nsamples': 750}, 'tweet-news': {'pearson': PearsonRResult(statistic=0.4320124762931009, pvalue=1.8779041372429452e-35), 'spearman': SignificanceResult(statistic=0.3973030661637119, pvalue=9.086444245352882e-30), 'nsamples': 750}, 'all': {'pearson': {'mean': 0.5120865605779554, 'wmean': 0.5246730601775753}, 'spearman': {'mean': 0.5021491957233841, 'wmean': 0.5139366042286256}}}}
